name: Build FortiusANT

on: [push]

jobs:
  build:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-python@v2
      with:
        python-version: 3.7
    - name: Get libusb
      run: |
        bitsadmin /create myDownloadJob
        bitsadmin /addfile myDownloadJob https://sourceforge.net/projects/libusb-win32/files/libusb-win32-releases/1.2.6.0/libusb-win32-bin-1.2.6.0.zip libusb-win32-bin-1.2.6.0.zip
        bitsadmin /resume myDownloadJob
        bitsadmin /complete myDownloadJob
        tar -xf libusb-win32-bin-1.2.6.0.zip
    - name: Install dependencies
      run: |
        cd pythoncode
        python -m pip install --upgrade pip
        pip install pyinstaller
        pip install -r requirements.txt
    - name: Build executable
      run: |
        cd pythoncode
        pyinstaller --clean MakeFortiusANT.spec
